{{>layouts/header}}
<!-- 새글 작성 폼 -->
<div class="container" id="articles-new">
    <!-- 제목 입력 -->
    <div class="mb-3">
        <label class="form-label">제목</label>

        <input type="text" class="form-control" id="new-article-title">
    </div>
    <!-- 내용 입력 -->
    <div class="mb-3">
        <label class="form-label">내용</label>
        <textarea class="form-control" rows="3" id="new-article-content"></textarea>
    </div>
    <!-- 히든 인풋 -->
    {{#article}}
        <input type="hidden" id="new-article-id" value="{{id}}">
    {{/article}}
    <!-- 전송 버튼 -->
    <button type="submit" class="btn btn-primary" id="article-create-btn">Submit</button>
    <a href="/articles">Back</a>
</div>

{{>layouts/footer}}

<script>
    {
        //article 버튼 변수화
        const articleCreateBtn = document.querySelector("#article-create-btn");

        articleCreateBtn.addEventListener("click", function (){
            const article = {
                title: document.querySelector("#new-article-title").value,
                content: document.querySelector("#new-article-content").value,
            };
            console.log(article);

            const url = "/api/articles";
            fetch(url, {
                method: "POST",
                body: JSON.stringify(article),
                headers: {
                    "Content-Type": "application/json"
                }
            }).then(respnse =>{
                const msg = (respnse.ok) ? "게시글이 등록이되었습니다" : "댓글 등록 실패";
                alert(msg);
                link = "/articles";
                location.href = link;
            })
        })

    }
</script>